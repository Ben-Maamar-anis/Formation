<!-- pages/clients/clients.component.html -->
<div class="clients-container">
  
  <!-- Barre de recherche et filtres -->
  <div class="filters-section">
    <input 
      type="text"
      placeholder="Rechercher..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="search($event)"
    >
    <select [(ngModel)]="selectedStatus" (change)="filter()">
      <option value="all">Tous les statuts</option>
      <option value="client">Clients</option>
      <option value="prospect">Prospects</option>
      <option value="inactive">Inactifs</option>
    </select>
    <app-export-button 
      [clients]="filteredClients" 
      filename="clients_export">
    </app-export-button>
    <app-report-generator [clients]="clients"></app-report-generator>
  </div>
  <!-- ===== BARRE DE RECHERCHE ET FILTRES ===== -->
<div class="search-filter-container">
  
  <!-- Titre et compteur -->
  <div class="search-header">
    <h3>ğŸ” Recherche & Filtres</h3>
    <span class="result-count" *ngIf="hasActiveFilters">
      ğŸ“Š {{ filteredCount }} rÃ©sultat(s) trouvÃ©(s)
    </span>
  </div>

  <!-- Barre de recherche principale -->
  <div class="search-bar">
    <input 
      type="text" 
      class="search-input" 
      placeholder="ğŸ” Rechercher par nom, email, entreprise..."
      [(ngModel)]="searchTerm"
      (ngModelChange)="onFilterChange()"
      (keyup.enter)="filter()">
    
    <button 
      *ngIf="searchTerm" 
      class="clear-search-btn"
      (click)="searchTerm = ''; onFilterChange()"
      title="Effacer la recherche">
      âœ•
    </button>
  </div>

  <!-- Filtres avancÃ©s -->
  <div class="filters-grid">
    
    <!-- Filtre Statut -->
    <div class="filter-group">
      <label for="filter-status" class="filter-label">ğŸ“‹ Statut</label>
      <select 
        id="filter-status"
        class="filter-select" 
        [(ngModel)]="selectedStatus"
        (change)="onFilterChange()">
        <option value="all">Tous les statuts</option>
        <option value="client">Clients</option>
        <option value="prospect">Prospects</option>
        <option value="inactive">Inactifs</option>
      </select>
    </div>

    <!-- Filtre PrioritÃ© -->
    <div class="filter-group">
      <label for="filter-priority" class="filter-label">â­ PrioritÃ©</label>
      <select 
        id="filter-priority"
        class="filter-select" 
        [(ngModel)]="selectedPriority"
        (change)="onFilterChange()">
        <option value="all">Toutes les prioritÃ©s</option>
        <option value="haute">Haute</option>
        <option value="moyenne">Moyenne</option>
        <option value="basse">Basse</option>
      </select>
    </div>

    <!-- Filtre Revenue Min -->
    <div class="filter-group">
      <label for="filter-min-revenue" class="filter-label">ğŸ’° Revenue Min</label>
      <input 
        id="filter-min-revenue"
        type="number" 
        class="filter-input" 
        placeholder="Minimum"
        [(ngModel)]="minRevenue"
        (ngModelChange)="onFilterChange()">
    </div>

    <!-- Filtre Revenue Max -->
    <div class="filter-group">
      <label for="filter-max-revenue" class="filter-label">ğŸ’° Revenue Max</label>
      <input 
        id="filter-max-revenue"
        type="number" 
        class="filter-input" 
        placeholder="Maximum"
        [(ngModel)]="maxRevenue"
        (ngModelChange)="onFilterChange()">
    </div>
  </div>

  <!-- Bouton Effacer les filtres -->
  <div class="filter-actions">
    <button 
      *ngIf="hasActiveFilters"
      class="clear-filters-btn"
      (click)="clearAllFilters()"
      title="RÃ©initialiser tous les filtres">
      âœ• Effacer tous les filtres
    </button>
  </div>

  <!-- Statistiques des rÃ©sultats -->
  <div class="filter-stats" *ngIf="hasActiveFilters">
    <div class="stat-item">
      <span class="stat-label">Total:</span>
      <span class="stat-value">{{ filteredStats.total }}</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Clients:</span>
      <span class="stat-value">{{ filteredStats.clients }}</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Prospects:</span>
      <span class="stat-value">{{ filteredStats.prospects }}</span>
    </div>
    <div class="stat-item">
      <span class="stat-label">Revenue:</span>
      <span class="stat-value">{{ filteredStats.revenue | currency }}</span>
    </div>
  </div>
</div>

<!-- Message si aucun rÃ©sultat -->
<div *ngIf="hasActiveFilters && filteredCount === 0" class="no-results">
  <p>ğŸ˜• Aucun client ne correspond Ã  vos critÃ¨res de recherche</p>
  <button (click)="clearAllFilters()" class="btn-reset-search">
    RÃ©initialiser les filtres
  </button>
</div>


  <!-- Tableau des clients -->
  <div class="table-wrapper">
    <table class="clients-table">
      <thead>
        <tr>
          <th>Nom</th>
          <th>Email</th>
          <th>TÃ©lÃ©phone</th>
          <th>Statut</th>
          <th>Actions</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let client of paginatedClients">
          <td>{{ client.name }}</td>
          <td>{{ client.email }}</td>
          <td>{{ client.phone }}</td>
          <td>
            <span class="status-badge" [ngClass]="'status-' + client.status">
              {{ client.status }}
            </span>
          </td>
          <td class="actions">
            <button (click)="onClientSelected(client)" class="btn-view" title="Voir">ğŸ‘ï¸</button>
            <button (click)="onClientEdited(client)" class="btn-edit" title="Ã‰diter">âœï¸</button>
            <button (click)="deleteClient(client.id)" class="btn-delete" title="Supprimer">ğŸ—‘ï¸</button>
          </td>
        </tr>
      </tbody>
    </table>
  </div>

  <!-- Message si aucun client -->
  <div *ngIf="filteredClients.length === 0" class="no-results">
    Aucun client trouvÃ©
  </div>
<!-- ===== PAGINATION ===== -->
<div class="pagination-container">
  <!-- Information de page -->
  <div class="pagination-info">
    Page <strong>{{ currentPage }}</strong> / <strong>{{ totalPages }}</strong>
    ({{ paginatedClients.length }} clients)
  </div>

  <!-- Boutons de navigation -->
  <!-- Boutons de navigation -->
<div class="pagination-buttons">
  <!-- Bouton PrÃ©cÃ©dent -->
  <button 
    class="btn-pagination" 
    (click)="hasActiveFilters ? goPreviousFilteredPage() : goPreviousPage()"
    [disabled]="currentPage === 1"
    title="Aller Ã  la page prÃ©cÃ©dente">
    â—€ PrÃ©cÃ©dent
  </button>

  <!-- Boutons numÃ©ros de page -->
  <button 
    *ngFor="let pageNum of getPageNumbers()" 
    class="btn-pagination"
    [class.active]="pageNum === currentPage"
    (click)="hasActiveFilters ? goToFilteredPage(pageNum) : goToPage(pageNum)"
    [title]="'Aller Ã  la page ' + pageNum">
    {{ pageNum }}
  </button>

  <!-- Bouton Suivant -->
  <button 
    class="btn-pagination" 
    (click)="hasActiveFilters ? goNextFilteredPage() : goNextPage()"
    [disabled]="currentPage === totalPages"
    title="Aller Ã  la page suivante">
    Suivant â–¶
  </button>
</div>

</div>

</div>
